<!DOCTYPE html>
<html>

<head>
    <title>Roomiez</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- W3 Schools Stylesheets -->
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-green.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
        body {
            font-family: "Courier New", monospace
        }
    </style>
</head>

<body>
    <!-- NAVIGATION BAR -->
    <nav class="w3-bar w3-theme-d5 w3-padding">
        <a href="#" class="w3-bar-item w3-button"><b>ROOMIEZ</b></a>
        <div class="w3-dropdown-hover">
            <button class="w3-button">Browse</button>
            <div class="w3-dropdown-content w3-bar-block w3-card-4">
                <a href="roommates.html" class="w3-bar-item w3-button">Roommates</a>
                <a href="rooms.html" class="w3-bar-item w3-button">Rooms</a>
            </div>
        </div>
        <a href="login.html" class="w3-bar-item w3-button">Sign In/Register</a>
        <div id="signedIn">
            <a href="profile.html" class="w3-bar-item w3-button">User Profile</a>
            <a href="listing.html" class="w3-bar-item w3-button">User Listings</a>
            <a id="logout" class="w3-bar-item w3-button">Log out</a>
        </div>
    </nav>

    <h1>Welcome to ROOMIEZ</h1>
    <div id="loginScreen">
        <button id="login">Login with Google</button>
    </div>

    <!-- <div id="dashboard">
        <div id="userDetail"></div>
    </div> -->

    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-app.js"></script>
    <!-- FIREBASE AUTHENTICATION -->
    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-auth.js"></script>
    <!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-analytics.js"></script>
    <script>
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        var firebaseConfig = {
            apiKey: "AIzaSyC4El1FbprSPpcq0FlRxzm79mE6vyU2dEY",
            authDomain: "summer21-sps-7.firebaseapp.com",
            projectId: "summer21-sps-7",
            storageBucket: "summer21-sps-7.appspot.com",
            messagingSenderId: "1046630479691",
            appId: "1:1046630479691:web:596d4dbc7586b5152f9ace",
            measurementId: "G-GETT4XG4HE"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();

        // document.getElementById('dashboard').style.display = "none";
        document.getElementById('signedIn').style.display = "none";
        document.getElementById('login').addEventListener('click', GoogleLogin)
        document.getElementById('logout').addEventListener('click', LogoutUser)

        let provider = new firebase.auth.GoogleAuthProvider()

        function GoogleLogin() {
            console.log('Login Btn Call')
            firebase.auth().signInWithPopup(provider).then(res => {
                console.log(res.user)
                // document.getElementById('dashboard').style.display = "block";
                document.getElementById('loginScreen').style.display = "none";
                document.getElementById('signedIn').style.display = "block";
                // showUserDetails(res.user);
                window.location = "roommates.html";
            }).catch(e => {
                console.log(e)
            })
        }

        // function showUserDetails(user) {
        //     document.getElementById('userDetail').innerHTML = `
        //         <img src="${user.photoURL}" style="width:10%">
        //         <p>Name: ${user.displayName}</p>
        //         <p>Email: ${user.email}</p>
        //     `
        // }

        function checkAuthState() {
            firebase.auth().onAuthStateChanged(user => {
                if (user) {
                    // document.getElementById('dashboard').style.display = "block";
                    document.getElementById('loginScreen').style.display = "none";
                    document.getElementById('signedIn').style.display = "block";
                    showUserDetails(user)
                } else {

                }
            })
        }

        function LogoutUser() {
            console.log('Logout Btn Call')
            firebase.auth().signOut().then(() => {
                window.location = "login.html";
                document.getElementById('loginScreen').style.display = "block";
                // document.getElementById('dashboard').style.display = "none";
            }).catch(e => {
                console.log(e)
            })
        }
        checkAuthState()

    </script>

</body>

</html>